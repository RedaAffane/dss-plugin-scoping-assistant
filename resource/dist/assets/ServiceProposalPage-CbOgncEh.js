import{Q as N}from"./QPage-BvaG2vQH.js";import{Q as P,a as x,b as j,c as A,G as K,f as $,h as O,i as W,j as Y,k as z,l as H}from"./GenerationProcess-Czo_aAIo.js";import{b as S,Q as J}from"./QBtn-BqAABnS7.js";import{e as i,r as c,K as D,L as V,M as r,Q as u,O as n,P as w,T as p}from"./index-BtPKUw67.js";import"./render-BXVSlnlj.js";import"./format-Dls-aKGN.js";import"./use-dark-Ct4T5hl3.js";const X={class:"row q-col-gutter-xl"},Z={class:"col-12"},ee={class:"row q-col-gutter-xl"},se={class:"col-12"},ae={class:"row q-col-gutter-xl"},te={class:"col-12"},le={class:"row q-col-gutter-xl"},oe={class:"col-12"},ne={class:"row q-col-gutter-xl q-mt-xl"},re={class:"col-12"},ie={__name:"ServiceProposalForm",emits:["submit","generateServiceProposal"],setup(B,{emit:_}){const t=_,g=i("isGenerating"),m=i("hasGenerated"),o=c({sePrePitchQuestions:"",notes:"",slScopingQuestions:"",slMeetingTranscript:null}),v=()=>{t("submit",o.value)},f=()=>{console.log("Upload SE pre-pitch questions")},b=()=>{console.log("Upload SL scoping questions")},y=()=>{console.log("Upload SL meeting transcript")},G=()=>{g.value=!0,m.value=!0,t("generateServiceProposal",o.value)};return(C,e)=>(V(),D(A,{onSubmit:v,class:"q-gutter-xl"},{default:r(()=>[u("div",X,[u("div",Z,[n(P,{modelValue:o.value.sePrePitchQuestions,"onUpdate:modelValue":e[0]||(e[0]=s=>o.value.sePrePitchQuestions=s),label:"SE pre-pitch scoping questions & answers",type:"url",rules:[s=>!!s||"Field is required"],class:"q-mb-md"},{append:r(()=>[n(S,{flat:"",round:"",icon:"upload_file",onClick:f},{default:r(()=>[n(x,null,{default:r(()=>e[4]||(e[4]=[w("Upload SE Pre-pitch Questions")])),_:1,__:[4]})]),_:1})]),_:1},8,["modelValue","rules"])])]),u("div",ee,[u("div",se,[n(P,{modelValue:o.value.notes,"onUpdate:modelValue":e[1]||(e[1]=s=>o.value.notes=s),label:"Notes",type:"textarea",filled:"",autogrow:"",class:"q-mb-xl"},null,8,["modelValue"])])]),u("div",ae,[u("div",te,[n(P,{modelValue:o.value.slScopingQuestions,"onUpdate:modelValue":e[2]||(e[2]=s=>o.value.slScopingQuestions=s),label:"SL scoping questions and answers",type:"url",rules:[s=>!!s||"Field is required"],class:"q-mb-md"},{append:r(()=>[n(S,{flat:"",round:"",icon:"upload_file",onClick:b},{default:r(()=>[n(x,null,{default:r(()=>e[5]||(e[5]=[w("Upload SL Scoping Questions")])),_:1,__:[5]})]),_:1})]),_:1},8,["modelValue","rules"])])]),u("div",le,[u("div",oe,[n(j,{modelValue:o.value.slMeetingTranscript,"onUpdate:modelValue":e[3]||(e[3]=s=>o.value.slMeetingTranscript=s),label:"SL scoping meeting transcript",accept:".txt,.doc,.docx,.pdf",rules:[s=>!!s||"Field is required"],class:"q-mb-md"},{prepend:r(()=>[n(J,{name:"description"})]),append:r(()=>[n(S,{flat:"",round:"",icon:"upload_file",onClick:y},{default:r(()=>[n(x,null,{default:r(()=>e[6]||(e[6]=[w("Upload Transcript")])),_:1,__:[6]})]),_:1})]),_:1},8,["modelValue","rules"])])]),u("div",ne,[u("div",re,[n(S,{color:"secondary",label:"Generate Service proposal",class:"full-width",loading:p(g),onClick:G},null,8,["loading"])])])]),_:1}))}},fe={__name:"ServiceProposalPage",setup(B){const _=i("hasGenerated"),t=i("isGenerating"),g=i("summaryData"),m=i("similarDocsData"),o=i("serviceDaysData"),v=i("assumptionsData"),f=i("blueprintsData"),b=i("hasGeneratedScoping"),y=i("isGeneratingScoping"),G=i("scopingData"),C=c(null),e=c(0),s=c({message1:!0,message2:!1,message3:!1,message3_5:!1,message4:!1,message5:!1,message6:!1,message7:!1,message8:!1}),h=c([]),q=c([]),d=c(!1),Q=c(!1),k=c(0),E=l=>{console.log("Form submitted:",l)},T=async l=>{e.value=0,s.value={message1:!0,message2:!1,message3:!1,message3_5:!1,message4:!1,message5:!1,message6:!1,message7:!1,message8:!1},h.value=[],q.value=[],d.value=!1,Q.value=!1,k.value++,b.value=!1,y.value=!1,G.value={analysisInputs:null,analysisTranscripts:null,scopingQuestions:null},console.log("Starting service proposal generation..."),setTimeout(()=>{const a=document.querySelector(".loading-section");a&&a.scrollIntoView({behavior:"smooth",block:"start"})},100);try{console.log("Step 1: Generating summary..."),e.value=1,s.value.message2=!0;const a=await $(l);if(!t.value){console.log("Generation stopped by user after step 1");return}g.value=a,console.log("Step 2: Generating similar documents..."),e.value=2,s.value.message3=!0;const U=await O(l);if(!t.value){console.log("Generation stopped by user after step 2");return}m.value=U,console.log("Step 3: Generating service days..."),e.value=2.5,s.value.message3_5=!0;const I=await W(l);if(!t.value){console.log("Generation stopped by user after step 3");return}o.value=I,console.log("Step 4: Generating assumptions..."),e.value=3,s.value.message4=!0;const M=await Y(l);if(!t.value){console.log("Generation stopped by user after step 4");return}v.value=M,console.log("Step 5: Asking about use-case blueprints..."),e.value=5,s.value.message5=!0,console.log("Waiting for user input (Yes/No)..."),t.value=!1}catch(a){console.error("Error generating service proposal:",a),alert("Error generating service proposal: "+a.message),t.value=!1}},L=async()=>{s.value.message6=!0,e.value=4,t.value=!0,console.log("Starting use case generation...");try{const l=await H({});if(!t.value){console.log("Use case generation stopped by user");return}h.value=l.use_cases,s.value.message7=!0,e.value=5,console.log("Use cases fetched, showing selection UI")}catch(l){console.error("Error fetching use cases:",l),alert("Error fetching use cases: "+l.message)}finally{t.value=!1}},F=()=>{Q.value=!0,console.log("Use case generation declined")},R=async l=>{try{e.value=6,s.value.message8=!0,d.value=!0,t.value=!0,console.log("Generating blueprints for selected use cases:",l);const a=await z(l);if(!t.value){console.log("Blueprint generation stopped by user"),d.value=!1;return}f.value=a,console.log("Blueprints generated successfully")}catch(a){console.error("Error generating blueprints:",a),alert("Error generating blueprints: "+a.message)}finally{d.value=!1,t.value=!1}};return(l,a)=>(V(),D(N,{class:"q-pa-xl q-ml-xl"},{default:r(()=>[a[1]||(a[1]=u("div",{class:"text-h4 q-mb-xl"},"Generate Service Proposal",-1)),n(ie,{onGenerateServiceProposal:T,onSubmit:E}),(V(),D(K,{key:k.value,ref_key:"loadingSection",ref:C,"is-generating":p(t),"has-generated":p(_),"current-step":e.value,"message-states":s.value,"summary-data":p(g),"similar-docs-data":p(m),"service-days-data":p(o),"assumptions-data":p(v),"blueprints-data":p(f),"use-cases":h.value,"selected-use-cases":q.value,"onUpdate:selectedUseCases":a[0]||(a[0]=U=>q.value=U),"use-case-declined":Q.value,"generating-blueprints":d.value,onStartUseCaseGeneration:L,onSkipUseCaseGeneration:F,onGenerateBlueprints:R},null,8,["is-generating","has-generated","current-step","message-states","summary-data","similar-docs-data","service-days-data","assumptions-data","blueprints-data","use-cases","selected-use-cases","use-case-declined","generating-blueprints"]))]),_:1,__:[1]}))}};export{fe as default};
